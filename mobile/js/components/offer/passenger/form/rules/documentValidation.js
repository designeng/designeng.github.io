var __bind=function(e,t){return function(){return e.apply(t,arguments)}},__indexOf=[].indexOf||function(e){for(var t=0,n=this.length;t<n;t++)if(t in this&&this[t]===e)return t;return-1};define(["underscore","moment","meld","core/util/config/getLocalizedName","./assets/documentTypesRules"],function(e,t,n,r,i){var s,o,u;return o="nameEn",u=r(),s=function(){function n(){this.lastLegEndIsBeforeExpirationDateRule=__bind(this.lastLegEndIsBeforeExpirationDateRule,this),this.documentExpirationDateRule=__bind(this.documentExpirationDateRule,this),this.documentTypeRule=__bind(this.documentTypeRule,this),this.onDataDelivered=__bind(this.onDataDelivered,this)}return n.prototype.documentTypes=void 0,n.prototype.documentTypesList=["RUSSIAN_PASSPORT","RUSSIAN_INTERNATIONAL_PASSPORT","NATIONAL_PASSPORT","RUSSIAN_BIRTH_CERTIFICATE"],n.prototype.setDocumentTypesList=function(e){return this.documentTypesList=e,e},n.prototype.getFirstFlightDateTime=function(){return this.response.flight.segments[0].start.dateTime},n.prototype.getLastLegEndDateTime=function(){var t;return t=e.last(e.last(this.response.flight.segments).legs).end.dateTime,t},n.prototype.onInit=function(){return this.deliveryResults=[]},n.prototype.onReady=function(){return this.nonExpirableDocumentTypesList=e.map(e.filter(this.documentTypes,function(e){return e.expirable===!1}),function(e){return e.id}),this.documentTypesRules=i(this.documentTypes,this.passengerCategory)},n.prototype.isRussianDocumentsZoneInvoker=function(e){return{name:"russianDocumentsZone",value:e.isRussianDocumentsZone}},n.prototype.categoryInvoker=function(e){return{name:"category",value:e}},n.prototype.onDataDelivered=function(t){var n,r,i,s,o,a;return r=e.find(this.deliveryResults,{name:t.name}),r==null?this.deliveryResults.push(t):r.value=t.value,n=e.find(this.deliveryResults,{name:"birthDate"})!=null&&e.find(this.deliveryResults,{name:"citizenship"})!=null,s=e.reduce(this.deliveryResults,function(t){return function(n,r){var i;return i=t.documentTypesFilters[r.name](r.value),e.filter(n,i)}}(this),this.documentTypes),o=e.map(s,function(e){return e.id}),this.setDocumentTypesList(o),a=e.map(s,function(e){return e[u]}),i={resultTypesLocalized:a,isHint:n},this.onDataDeliveredResult(i)},n.prototype.onDataDeliveredResult=function(e){return e},n.prototype.getDocumentTypeIds=function(t){var n,r;return r=e.filter(this.documentTypesRules,function(t){return function(n){var r;return r=e.keys(n)[0],__indexOf.call(t.documentTypesList,r)>=0}}(this)),n=e.reduce(r,function(n,r,i){var s,o;return s=e.keys(r)[0],o=t.match(e.values(r)[0]),o!=null&&n.push(s),n},[]),n},n.prototype.blockValidUntilField=function(t){var n;return n=e.intersection(t,this.nonExpirableDocumentTypesList).length,n?!0:!1},n.prototype.documentTypeRule=function(e){var t;return t=this.getDocumentTypeIds(e),t.length},n.prototype.documentExpirationDateRule=function(e){return!0},n.prototype.lastLegEndIsBeforeExpirationDateRule=function(e){return t(this.getLastLegEndDateTime()).isBefore(t(e))},n}(),s});
