define(["underscore","when","core/util/navigation/navigateToError"],function(e,t,n){var r;return r=function(){function r(){}return r.prototype.loadModule=function(e){return this.pluginWireFn.loadModule(e).then(function(e){return e},function(e){return n("js",e)})},r.prototype.getMergedModulesArrayOfPromises=function(t,n){var r,i,s,o;i=[],i.push(this.loadModule(t));if(n)if(e.isString(n))i.push(this.loadModule(n));else{if(!e.isArray(n))throw new Error("mergeWith option has unsupported format!");for(s=0,o=n.length;s<o;s++)r=n[s],i.push(this.loadModule(r))}return i},r.prototype.applyEnvironment=function(t,n){return t=e.extend(t,n),typeof n.behavior!="undefined"&&(t.$plugins||(t.$plugins=[]),t.$plugins.push("core/plugin/behavior")),t},r.prototype.loadInEnvironment=function(e,n,r,i){var s,o;return o=this.getMergedModulesArrayOfPromises(e,n),s=function(e){return e},t.all(o).then(function(e){return function(t){return t[0]=e.applyEnvironment(t[0],r),i?i.wire(t).then(s):e.pluginWireFn.createChild(t).then(s)}}(this),function(e){return console.debug("Environment::loadInEnvironment reject reason:",e)})},r}()});
