define(["when","core/util/navigation/navigateToError","./tasksFactory"],function(e,t,n){var r;return r=function(){function r(){var e;_.bindAll(this),e=["defineChildObject","getCached","loadNotCached","sequenceBehavior"],this.tasksFactory=new n(this,e)}return r.prototype.createHandler=function(e){return this.tasksFactory.runTasks(e)},r.prototype.defineChildObject=function(e){return this.child=this.routeStrategy.getChild(e.route),this.contextController.startContextHashRevision(this.child),e},r.prototype.getCached=function(t){var n,r;return n=e.defer(),r=this.contextController.getRegistredContext(this.child.route,"parent"),r!=null?(this.processChildRoute(r,this.child),n.reject("CACHED")):n.resolve(t),n.promise},r.prototype.loadNotCached=function(n){var r;return r={slot:n.slot},e(this.environment.loadInEnvironment(n.spec,n.mergeWith,r)).then(function(e){return function(t){return e.processChildRoute(t),t}}(this)).otherwise(function(e){return t("js",e)})},r.prototype.processChildRoute=function(e){var t,n;return t=[],t.push(this.child),this.child.relative&&(n=_.find(this.childRoutes,{spec:this.child.relative}),n.route=this.routeStrategy.getComponentRoute(this.child.relative),t.push(n)),this.childContextProcessor.deliver(e,t)},r.prototype.sequenceBehavior=function(e){return e.behavior!=null?this.behaviorProcessor.sequenceBehavior(e):e},r}()});
