define(["underscore","core/util/dictionary/getDictionaryData","core/util/config/getLocalizedName","./isRussianDocumentsZone"],function(e,t,n,r){var i,s;return s=function(n){return e.reduce(n.flight.segments,function(r,i){var s;return s=e.reduce(i.legs,function(e,r){var i;return i=t(r.marketingCompany.id,r.marketingCompany.type,n.dictionary),e&&i.bonusProgramName!=null},!0),r&&s},!0)},i=function(){function n(t){var n,i,o,u,a,f,l,c,h,p;return a=t.data.flight,c=t.data.pricings,l=a.persons!=null?a.persons:t.data.persons,o=t.dictionary,n=this.getAirCompany(a,o),i=t.data.flight.blank.countPerPassenger,u=this.getFirstMarketingCompany(t),f=t.data.flight.international,p=t.properties.warnings,h={flight:a,pricings:c,persons:l,dictionary:o,airCompany:n,countPerPassenger:i,firstMarketingCompany:u,warnings:p,international:f},h=e.extend(h,{isBonusCardProgram:s(h),isRussianDocumentsZone:r(h)}),h}return n.prototype.getAirCompany=function(t,n){var r,i,s,o,u,a,f,l,c,h,p,d;s={},p=t.segments;for(f=0,c=p.length;f<c;f++){a=p[f],d=a.legs;for(l=0,h=d.length;l<h;l++)i=d[l],o=e.where(n[i.marketingCompany.type],{id:i.marketingCompany.id})[0],i.marketingCompany.name=this.getExistingField(o,"nameRu","nameEn"),s[i.marketingCompany.id]=i.marketingCompany}u=[];for(r in s)u.push(s[r]);return u},n.prototype.getExistingField=function(e,t,n){return e[t]?e[t]:e[n]},n.prototype.getFirstMarketingCompany=function(e){var n;return n=e.data.flight.segments[0].legs[0].marketingCompany,t(n.id,n.type,e.dictionary)},n}()});
